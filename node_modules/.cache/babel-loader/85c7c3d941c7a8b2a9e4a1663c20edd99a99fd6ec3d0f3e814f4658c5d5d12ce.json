{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Users,Wifi,WifiOff,X}from'lucide-react';import socketService from'../services/socketService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const OnlineUsersList=_ref=>{let{boardId,isOpen,onClose}=_ref;const[onlineUsers,setOnlineUsers]=useState([]);const[isConnected,setIsConnected]=useState(false);useEffect(()=>{if(!isOpen||!boardId)return;// Join board room\nsocketService.joinBoard(boardId);const handleUserJoined=user=>{setOnlineUsers(prev=>{const exists=prev.find(u=>u.userId===user.userId);if(!exists)return[...prev,user];return prev;});};const handleUserLeft=user=>{setOnlineUsers(prev=>prev.filter(u=>u.userId!==user.userId));};const handleOnlineUsers=payload=>{if(!payload||payload.boardId!==boardId)return;setOnlineUsers(payload.users||[]);};const handleConnect=()=>setIsConnected(true);const handleDisconnect=()=>{setIsConnected(false);setOnlineUsers([]);};// Set up listeners via service API\nsocketService.onUserJoined(handleUserJoined);socketService.onUserLeft(handleUserLeft);socketService.onOnlineUsers(handleOnlineUsers);socketService.onConnect(handleConnect);socketService.onDisconnect(handleDisconnect);return()=>{socketService.offUserJoined(handleUserJoined);socketService.offUserLeft(handleUserLeft);socketService.offOnlineUsers(handleOnlineUsers);socketService.leaveBoard(boardId);};},[isOpen,boardId]);if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-lg w-full max-w-md mx-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center border-b px-6 py-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-lg font-semibold flex items-center\",children:[/*#__PURE__*/_jsx(Users,{size:20,className:\"mr-2\"}),\"Online Users\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-500 hover:text-gray-700 p-1 rounded-full\",children:/*#__PURE__*/_jsx(X,{size:20})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:!isConnected?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center py-8\",children:[/*#__PURE__*/_jsx(WifiOff,{size:24,className:\"text-gray-400 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Offline\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(Wifi,{size:16,className:\"text-green-500 mr-2\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[onlineUsers.length+1,\" user(s) online\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium mr-3\",children:\"You\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800\",children:\"You\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Current user\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full\"})})]}),onlineUsers.map(user=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center text-white text-sm font-medium mr-3\",children:user.username.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800\",children:user.username}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Online\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full\"})})]},user.userId)),onlineUsers.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(Users,{size:32,className:\"mx-auto mb-2 text-gray-300\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No other users online\"})]})]})]})})]})});};export default OnlineUsersList;","map":{"version":3,"names":["React","useState","useEffect","Users","Wifi","WifiOff","X","socketService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","OnlineUsersList","_ref","boardId","isOpen","onClose","onlineUsers","setOnlineUsers","isConnected","setIsConnected","joinBoard","handleUserJoined","user","prev","exists","find","u","userId","handleUserLeft","filter","handleOnlineUsers","payload","users","handleConnect","handleDisconnect","onUserJoined","onUserLeft","onOnlineUsers","onConnect","onDisconnect","offUserJoined","offUserLeft","offOnlineUsers","leaveBoard","className","children","size","onClick","length","map","username","charAt","toUpperCase"],"sources":["E:/Ngon-ngu-kich-ban/ToDo-fontend/src/components/OnlineUsersList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Users, Wifi, WifiOff, X } from 'lucide-react';\r\nimport socketService from '../services/socketService';\r\n\r\nconst OnlineUsersList = ({ boardId, isOpen, onClose }) => {\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isOpen || !boardId) return;\r\n\r\n    // Join board room\r\n    socketService.joinBoard(boardId);\r\n\r\n    const handleUserJoined = (user) => {\r\n      setOnlineUsers(prev => {\r\n        const exists = prev.find(u => u.userId === user.userId);\r\n        if (!exists) return [...prev, user];\r\n        return prev;\r\n      });\r\n    };\r\n\r\n    const handleUserLeft = (user) => {\r\n      setOnlineUsers(prev => prev.filter(u => u.userId !== user.userId));\r\n    };\r\n\r\n    const handleOnlineUsers = (payload) => {\r\n      if (!payload || payload.boardId !== boardId) return;\r\n      setOnlineUsers(payload.users || []);\r\n    };\r\n\r\n    const handleConnect = () => setIsConnected(true);\r\n    const handleDisconnect = () => { setIsConnected(false); setOnlineUsers([]); };\r\n\r\n    // Set up listeners via service API\r\n    socketService.onUserJoined(handleUserJoined);\r\n    socketService.onUserLeft(handleUserLeft);\r\n    socketService.onOnlineUsers(handleOnlineUsers);\r\n    socketService.onConnect(handleConnect);\r\n    socketService.onDisconnect(handleDisconnect);\r\n\r\n    return () => {\r\n      socketService.offUserJoined(handleUserJoined);\r\n      socketService.offUserLeft(handleUserLeft);\r\n      socketService.offOnlineUsers(handleOnlineUsers);\r\n      socketService.leaveBoard(boardId);\r\n    };\r\n  }, [isOpen, boardId]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-xl shadow-lg w-full max-w-md mx-4\">\r\n        <div className=\"flex justify-between items-center border-b px-6 py-4\">\r\n          <h2 className=\"text-lg font-semibold flex items-center\">\r\n            <Users size={20} className=\"mr-2\" />\r\n            Online Users\r\n          </h2>\r\n          <button onClick={onClose} className=\"text-gray-500 hover:text-gray-700 p-1 rounded-full\">\r\n            <X size={20} />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-6\">\r\n          {!isConnected ? (\r\n            <div className=\"flex items-center justify-center py-8\">\r\n              <WifiOff size={24} className=\"text-gray-400 mr-2\" />\r\n              <span className=\"text-gray-500\">Offline</span>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              <div className=\"flex items-center mb-4\">\r\n                <Wifi size={16} className=\"text-green-500 mr-2\" />\r\n                <span className=\"text-sm text-gray-600\">\r\n                  {onlineUsers.length + 1} user(s) online\r\n                </span>\r\n              </div>\r\n              \r\n              <div className=\"space-y-3\">\r\n                {/* Current user */}\r\n                <div className=\"flex items-center p-3 bg-blue-50 rounded-lg\">\r\n                  <div className=\"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium mr-3\">\r\n                    You\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"font-medium text-gray-800\">You</div>\r\n                    <div className=\"text-xs text-gray-500\">Current user</div>\r\n                  </div>\r\n                  <div className=\"ml-auto\">\r\n                    <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* Other online users */}\r\n                {onlineUsers.map((user) => (\r\n                  <div key={user.userId} className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\r\n                    <div className=\"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center text-white text-sm font-medium mr-3\">\r\n                      {user.username.charAt(0).toUpperCase()}\r\n                    </div>\r\n                    <div>\r\n                      <div className=\"font-medium text-gray-800\">{user.username}</div>\r\n                      <div className=\"text-xs text-gray-500\">Online</div>\r\n                    </div>\r\n                    <div className=\"ml-auto\">\r\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n                \r\n                {onlineUsers.length === 0 && (\r\n                  <div className=\"text-center py-8 text-gray-500\">\r\n                    <Users size={32} className=\"mx-auto mb-2 text-gray-300\" />\r\n                    <p>No other users online</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OnlineUsersList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}