{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Users,Wifi,WifiOff}from'lucide-react';import socketService from'../services/socketService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OnlineUsers=_ref=>{let{boardId}=_ref;const[onlineUsers,setOnlineUsers]=useState([]);const[isConnected,setIsConnected]=useState(false);useEffect(()=>{var _socketService$socket,_socketService$socket2;if(!boardId)return;// Join board room\nsocketService.joinBoard(boardId);// Event listeners\nconst handleUserJoined=user=>{setOnlineUsers(prev=>{const exists=prev.find(u=>u.userId===user.userId);if(!exists){return[...prev,user];}return prev;});};const handleUserLeft=user=>{setOnlineUsers(prev=>prev.filter(u=>u.userId!==user.userId));};const handleConnect=()=>{setIsConnected(true);};const handleDisconnect=()=>{setIsConnected(false);setOnlineUsers([]);};// Set up listeners\nsocketService.onUserJoined(handleUserJoined);socketService.onUserLeft(handleUserLeft);(_socketService$socket=socketService.socket)===null||_socketService$socket===void 0?void 0:_socketService$socket.on('connect',handleConnect);(_socketService$socket2=socketService.socket)===null||_socketService$socket2===void 0?void 0:_socketService$socket2.on('disconnect',handleDisconnect);// Cleanup\nreturn()=>{var _socketService$socket3,_socketService$socket4;socketService.offUserJoined(handleUserJoined);socketService.offUserLeft(handleUserLeft);(_socketService$socket3=socketService.socket)===null||_socketService$socket3===void 0?void 0:_socketService$socket3.off('connect',handleConnect);(_socketService$socket4=socketService.socket)===null||_socketService$socket4===void 0?void 0:_socketService$socket4.off('disconnect',handleDisconnect);socketService.leaveBoard(boardId);};},[boardId]);if(!isConnected){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 text-gray-500\",children:[/*#__PURE__*/_jsx(WifiOff,{size:16}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Offline\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Wifi,{size:16,className:\"text-green-500\"}),/*#__PURE__*/_jsx(Users,{size:16,className:\"text-gray-600\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[onlineUsers.length+1,\" online\"]})]}),onlineUsers.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex -space-x-2\",children:[onlineUsers.slice(0,3).map(user=>/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\",title:user.username,children:user.username.charAt(0).toUpperCase()},user.userId)),onlineUsers.length>3&&/*#__PURE__*/_jsxs(\"div\",{className:\"w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\",children:[\"+\",onlineUsers.length-3]})]})]});};export default OnlineUsers;","map":{"version":3,"names":["React","useState","useEffect","Users","Wifi","WifiOff","socketService","jsx","_jsx","jsxs","_jsxs","OnlineUsers","_ref","boardId","onlineUsers","setOnlineUsers","isConnected","setIsConnected","_socketService$socket","_socketService$socket2","joinBoard","handleUserJoined","user","prev","exists","find","u","userId","handleUserLeft","filter","handleConnect","handleDisconnect","onUserJoined","onUserLeft","socket","on","_socketService$socket3","_socketService$socket4","offUserJoined","offUserLeft","off","leaveBoard","className","children","size","length","slice","map","title","username","charAt","toUpperCase"],"sources":["E:/Ngon-ngu-kich-ban/ToDo-fontend/src/components/OnlineUsers.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Users, Wifi, WifiOff } from 'lucide-react';\r\nimport socketService from '../services/socketService';\r\n\r\nconst OnlineUsers = ({ boardId }) => {\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!boardId) return;\r\n\r\n    // Join board room\r\n    socketService.joinBoard(boardId);\r\n\r\n    // Event listeners\r\n    const handleUserJoined = (user) => {\r\n      setOnlineUsers(prev => {\r\n        const exists = prev.find(u => u.userId === user.userId);\r\n        if (!exists) {\r\n          return [...prev, user];\r\n        }\r\n        return prev;\r\n      });\r\n    };\r\n\r\n    const handleUserLeft = (user) => {\r\n      setOnlineUsers(prev => prev.filter(u => u.userId !== user.userId));\r\n    };\r\n\r\n    const handleConnect = () => {\r\n      setIsConnected(true);\r\n    };\r\n\r\n    const handleDisconnect = () => {\r\n      setIsConnected(false);\r\n      setOnlineUsers([]);\r\n    };\r\n\r\n    // Set up listeners\r\n    socketService.onUserJoined(handleUserJoined);\r\n    socketService.onUserLeft(handleUserLeft);\r\n    socketService.socket?.on('connect', handleConnect);\r\n    socketService.socket?.on('disconnect', handleDisconnect);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      socketService.offUserJoined(handleUserJoined);\r\n      socketService.offUserLeft(handleUserLeft);\r\n      socketService.socket?.off('connect', handleConnect);\r\n      socketService.socket?.off('disconnect', handleDisconnect);\r\n      socketService.leaveBoard(boardId);\r\n    };\r\n  }, [boardId]);\r\n\r\n  if (!isConnected) {\r\n    return (\r\n      <div className=\"flex items-center space-x-2 text-gray-500\">\r\n        <WifiOff size={16} />\r\n        <span className=\"text-sm\">Offline</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex items-center space-x-2\">\r\n      <div className=\"flex items-center space-x-1\">\r\n        <Wifi size={16} className=\"text-green-500\" />\r\n        <Users size={16} className=\"text-gray-600\" />\r\n        <span className=\"text-sm text-gray-600\">\r\n          {onlineUsers.length + 1} online\r\n        </span>\r\n      </div>\r\n      \r\n      {onlineUsers.length > 0 && (\r\n        <div className=\"flex -space-x-2\">\r\n          {onlineUsers.slice(0, 3).map((user) => (\r\n            <div\r\n              key={user.userId}\r\n              className=\"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\"\r\n              title={user.username}\r\n            >\r\n              {user.username.charAt(0).toUpperCase()}\r\n            </div>\r\n          ))}\r\n          {onlineUsers.length > 3 && (\r\n            <div className=\"w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\">\r\n              +{onlineUsers.length - 3}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OnlineUsers;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}