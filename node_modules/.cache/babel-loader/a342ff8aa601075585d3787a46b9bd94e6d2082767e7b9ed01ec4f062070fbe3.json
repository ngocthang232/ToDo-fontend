{"ast":null,"code":"var _jsxFileName = \"E:\\\\Ngon-ngu-kich-ban\\\\ToDo-fontend\\\\src\\\\components\\\\OnlineUsers.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { Users, Wifi, WifiOff } from 'lucide-react';\nimport socketService from '../services/socketService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst OnlineUsers = ({\n  boardId\n}) => {\n  _s();\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [isConnected, setIsConnected] = useState(false);\n  const currentUser = (() => {\n    try {\n      return JSON.parse(localStorage.getItem('user') || '{}');\n    } catch {\n      return {};\n    }\n  })();\n  useEffect(() => {\n    var _socketService$socket, _socketService$socket2;\n    if (!boardId) return;\n\n    // Join board room\n    socketService.joinBoard(boardId);\n\n    // Event listeners\n    const handleUserJoined = user => {\n      if (user.userId === currentUser.id) return; // ignore self\n      setOnlineUsers(prev => {\n        const exists = prev.find(u => u.userId === user.userId);\n        if (!exists) {\n          return [...prev, user];\n        }\n        return prev;\n      });\n    };\n    const handleUserLeft = user => {\n      setOnlineUsers(prev => prev.filter(u => u.userId !== user.userId));\n    };\n    const handleConnect = () => {\n      setIsConnected(true);\n      socketService.joinBoard(boardId);\n    };\n    const handleDisconnect = () => {\n      setIsConnected(false);\n      setOnlineUsers([]);\n    };\n    const handleOnlineUsers = payload => {\n      if (!payload || payload.boardId !== boardId) return;\n      const others = (payload.users || []).filter(u => u.userId !== currentUser.id);\n      setOnlineUsers(others);\n    };\n\n    // Set up listeners\n    socketService.onUserJoined(handleUserJoined);\n    socketService.onUserLeft(handleUserLeft);\n    socketService.onOnlineUsers(handleOnlineUsers);\n    (_socketService$socket = socketService.socket) === null || _socketService$socket === void 0 ? void 0 : _socketService$socket.on('connect', handleConnect);\n    (_socketService$socket2 = socketService.socket) === null || _socketService$socket2 === void 0 ? void 0 : _socketService$socket2.on('disconnect', handleDisconnect);\n\n    // Cleanup\n    return () => {\n      var _socketService$socket3, _socketService$socket4;\n      socketService.offUserJoined(handleUserJoined);\n      socketService.offUserLeft(handleUserLeft);\n      socketService.offOnlineUsers(handleOnlineUsers);\n      (_socketService$socket3 = socketService.socket) === null || _socketService$socket3 === void 0 ? void 0 : _socketService$socket3.off('connect', handleConnect);\n      (_socketService$socket4 = socketService.socket) === null || _socketService$socket4 === void 0 ? void 0 : _socketService$socket4.off('disconnect', handleDisconnect);\n      socketService.leaveBoard(boardId);\n    };\n  }, [boardId, currentUser.id]);\n  if (!isConnected) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center space-x-2 text-gray-500\",\n      children: [/*#__PURE__*/_jsxDEV(WifiOff, {\n        size: 16\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm\",\n        children: \"Offline\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this);\n  }\n  const usernames = [currentUser === null || currentUser === void 0 ? void 0 : currentUser.username, ...onlineUsers.map(u => u.username)].filter(Boolean);\n  const namesPreview = usernames.slice(0, 3).join(', ');\n  const extra = usernames.length > 3 ? `, +${usernames.length - 3}` : '';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex items-center space-x-2\",\n    title: `${namesPreview}${extra}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center space-x-1\",\n      children: [/*#__PURE__*/_jsxDEV(Wifi, {\n        size: 16,\n        className: \"text-green-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Users, {\n        size: 16,\n        className: \"text-gray-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm text-gray-600\",\n        children: [onlineUsers.length + 1, \" online\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), onlineUsers.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex -space-x-2\",\n      children: [onlineUsers.slice(0, 3).map(user => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\",\n        title: user.username,\n        children: user.username.charAt(0).toUpperCase()\n      }, user.userId, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, this)), onlineUsers.length > 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\",\n        children: [\"+\", onlineUsers.length - 3]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n_s(OnlineUsers, \"Gr1YbB9Eq1wkbq7B5YNLLHg6F/w=\");\n_c = OnlineUsers;\nexport default OnlineUsers;\nvar _c;\n$RefreshReg$(_c, \"OnlineUsers\");","map":{"version":3,"names":["React","useState","useEffect","Users","Wifi","WifiOff","socketService","jsxDEV","_jsxDEV","OnlineUsers","boardId","_s","onlineUsers","setOnlineUsers","isConnected","setIsConnected","currentUser","JSON","parse","localStorage","getItem","_socketService$socket","_socketService$socket2","joinBoard","handleUserJoined","user","userId","id","prev","exists","find","u","handleUserLeft","filter","handleConnect","handleDisconnect","handleOnlineUsers","payload","others","users","onUserJoined","onUserLeft","onOnlineUsers","socket","on","_socketService$socket3","_socketService$socket4","offUserJoined","offUserLeft","offOnlineUsers","off","leaveBoard","className","children","size","fileName","_jsxFileName","lineNumber","columnNumber","usernames","username","map","Boolean","namesPreview","slice","join","extra","length","title","charAt","toUpperCase","_c","$RefreshReg$"],"sources":["E:/Ngon-ngu-kich-ban/ToDo-fontend/src/components/OnlineUsers.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Users, Wifi, WifiOff } from 'lucide-react';\r\nimport socketService from '../services/socketService';\r\n\r\nconst OnlineUsers = ({ boardId }) => {\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const currentUser = (() => {\r\n    try { return JSON.parse(localStorage.getItem('user') || '{}'); } catch { return {}; }\r\n  })();\r\n\r\n  useEffect(() => {\r\n    if (!boardId) return;\r\n\r\n    // Join board room\r\n    socketService.joinBoard(boardId);\r\n\r\n    // Event listeners\r\n    const handleUserJoined = (user) => {\r\n      if (user.userId === currentUser.id) return; // ignore self\r\n      setOnlineUsers(prev => {\r\n        const exists = prev.find(u => u.userId === user.userId);\r\n        if (!exists) {\r\n          return [...prev, user];\r\n        }\r\n        return prev;\r\n      });\r\n    };\r\n\r\n    const handleUserLeft = (user) => {\r\n      setOnlineUsers(prev => prev.filter(u => u.userId !== user.userId));\r\n    };\r\n\r\n    const handleConnect = () => {\r\n      setIsConnected(true);\r\n      socketService.joinBoard(boardId);\r\n    };\r\n\r\n    const handleDisconnect = () => {\r\n      setIsConnected(false);\r\n      setOnlineUsers([]);\r\n    };\r\n\r\n    const handleOnlineUsers = (payload) => {\r\n      if (!payload || payload.boardId !== boardId) return;\r\n      const others = (payload.users || []).filter(u => u.userId !== currentUser.id);\r\n      setOnlineUsers(others);\r\n    };\r\n\r\n    // Set up listeners\r\n    socketService.onUserJoined(handleUserJoined);\r\n    socketService.onUserLeft(handleUserLeft);\r\n    socketService.onOnlineUsers(handleOnlineUsers);\r\n    socketService.socket?.on('connect', handleConnect);\r\n    socketService.socket?.on('disconnect', handleDisconnect);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      socketService.offUserJoined(handleUserJoined);\r\n      socketService.offUserLeft(handleUserLeft);\r\n      socketService.offOnlineUsers(handleOnlineUsers);\r\n      socketService.socket?.off('connect', handleConnect);\r\n      socketService.socket?.off('disconnect', handleDisconnect);\r\n      socketService.leaveBoard(boardId);\r\n    };\r\n  }, [boardId, currentUser.id]);\r\n\r\n  if (!isConnected) {\r\n    return (\r\n      <div className=\"flex items-center space-x-2 text-gray-500\">\r\n        <WifiOff size={16} />\r\n        <span className=\"text-sm\">Offline</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const usernames = [currentUser?.username, ...onlineUsers.map(u => u.username)].filter(Boolean);\r\n  const namesPreview = usernames.slice(0, 3).join(', ');\r\n  const extra = usernames.length > 3 ? `, +${usernames.length - 3}` : '';\r\n\r\n  return (\r\n    <div className=\"flex items-center space-x-2\" title={`${namesPreview}${extra}`}>\r\n      <div className=\"flex items-center space-x-1\">\r\n        <Wifi size={16} className=\"text-green-500\" />\r\n        <Users size={16} className=\"text-gray-600\" />\r\n        <span className=\"text-sm text-gray-600\">\r\n          {onlineUsers.length + 1} online\r\n        </span>\r\n      </div>\r\n      \r\n      {onlineUsers.length > 0 && (\r\n        <div className=\"flex -space-x-2\">\r\n          {onlineUsers.slice(0, 3).map((user) => (\r\n            <div\r\n              key={user.userId}\r\n              className=\"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\"\r\n              title={user.username}\r\n            >\r\n              {user.username.charAt(0).toUpperCase()}\r\n            </div>\r\n          ))}\r\n          {onlineUsers.length > 3 && (\r\n            <div className=\"w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white\">\r\n              +{onlineUsers.length - 3}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OnlineUsers;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}